### 0723

next.js를 쓰는 이유를 알아보자.
넥스트는 풀스텍 프레임 워크임. 프런트 백엔드 전부 개발 가능함. 리액트 문법과 신기술을 도입해서 리액트 친화적임.
무엇보다 CSR->SSR 이 대세가 되어가면서

최근 몇년간 유행했던 Client-Side Rendering은 리액트 뷰같은 라이브러리를 써서 '유저 브라우저'에서 실시간으로 만들어줌. 페이지 전환이 앱같이 이쁘고 부드럽다. 하지만 구글 검색노출이 오래걸리고, 페이지 로딩속도가 떨어져 사이트 수익성에 매우 악영향임. 리액트 뷰를 쓰면 돈이 줄줄 세어나간다고.?
그래서 나온게 html을 서버에서 만드는걸 Server-Side Rendering(SSR)이라고함. 유저한테 js코드를 보낼 필요가 적고, html웹페이지를 서버에서 다 만들어서 보내주는 개념이기 때문에, 가볍고 검색 노출도 괜찮다. next.js에서는 원하는 페이지에서 선택적으로 CRS도 가능하기 때문에 안 쓸 이유가 없음.

물론 단점도 있는데

- 리액트 라이브러리의 신문법인 client component, server component를 도입해서 코드를 짜는데

그거 구분해서 코드짜는게 매우 귀찮고

- 많이 쓰진 않지만 WebSocket, WebRTC같은 기능을 이용해야한다면 직접 Nodejs + express 서버를 하나 더 만드는게 낫습니다.

프로젝트 파일 설명

- app 폴더 : 님들이 코드짤 폴더

- page.js : 메인페이지

- layout.js : 메인페이지 감싸는 용도의 페이지

- public 폴더 : 이미지나 static 파일 보관용

- api 폴더 : 서버기능 만드는 곳

- next.config.js : nextjs 설정 파일

- node_modules 폴더 : 설치한 라이브러리 보관용 폴더

- package.json : 설치한 라이브러리 버전 기록용 파일

- url로 페이지를 나누는 행위를 Routing이라고함.
- 참고로 REST API 원칙에 따르면 라우터 주소를 이쁘게 작성할 수 있다.
- next는 자동 라우팅 기능이 있다. next는 app하위에 폴더를 만들면 그게 곧 라우터 주소가 되며, 그 안의 page.js는 html가 된다.

- layout.js가 옆에 있는 경우, page.js는 layout.js에 담겨서 보여진다. 즉, layout.js에서 html태그안에 {children}이 page.js가 들어가는 부분이다.

- 세부적인 동작원리는

1. 옆에 layout.js가 있으면 그걸로 page.js를 싸맨다.
2. 상위폴더에 layout.js가 또 있다면 그걸로 1번 더 싸맨다.

즉 초기 세팅에 layout.js가 제일 최상단에 있기 때문에 폴더로 라우팅을 짜도, 저절로 layout.js에 있는 html구조로 감싸진다. ex)navbar. 결론은 page.js 보여줄 때는 옆에있는 것 우선, 그 다음은 상위로 추척하면서 모든 layout.js를 중첩해서 보여준다.

- 아무튼 결론: 페이지 변경과 상관없이 계속 보여줄 공통 UI는 layout.js 쓰면 편하겠죠.

* jsx에선 for문을 직접 못쓰므로, html반복하기 위핸 map()함수를 쓰자. Array.map((v,i)=>{ ~~~ }) 형식으로 쓰면 Array안에 있는 자료갯수만큼 똑같은 작용을 해준다.

* map(p1,p2) 안에 2개의 파라미터는 각각의 기능이 있다. 첫번째는 순서에 해당하는 값이, 두번째 파라미터는 index순서(0부터 1씩 증가)이다. 그리고 콜백 자리에 return을 담아 새로운 배열을 반환해줌.

* 이미지 최적화 방법은

1. lazy loading
2. 사이즈 최적화
3. layout shift방지(로딩이 늦게 돼서 레이아웃이 밀리는 현상)
   등이 있음.

- 하지만 next에서는 Image 라는 태그를 import해서 사용하면 자동으로 최적화를 해준다네! 단점이 있는데, src에 들어가는 이미지를 따로 import해서 네이밍한뒤 사용해야한다.
- 외부이미지 링크를 넣을때에도, width, height를 중괄호로 기입해서 넣어야한다. 뿐만 아니라, 사이트에 있는 이미지를 쓸때, config에 도메인, 경로 등록도 해야함. 대충 검색해서 알아보셈 이건. 최적화는 보통 다 만든 후에 하기 때문에 참고로 알아두자.
